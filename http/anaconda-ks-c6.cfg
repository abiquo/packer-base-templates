# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
# repo --name="CentOS"  --baseurl=cdrom:sr0 --cost=100
lang en_US.UTF-8
keyboard us
# network --onboot yes --device eth0 --bootproto dhcp --noipv6
%include /tmp/network.ks
rootpw  temporal
firewall --disabled
authconfig --enableshadow --passalgo=sha512
selinux --disabled
timezone --utc Europe/Madrid
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"

zerombr yes
clearpart --all --initlabel
part /boot --fstype=ext4 --size=500 --label=BOOT
part pv.01 --grow --size=1
volgroup centos --pesize=4096 pv.01
logvol / --fstype=ext4 --name=root --vgname=centos --grow --size=1024 --maxsize=51200
logvol swap --name=swap --vgname=centos --grow --size=409 --maxsize=409

skipx
reboot

%packages --nobase
@core

%pre
#!/bin/sh
for x in `cat /proc/cmdline`; do
  case $x in SERVERNAME*)
    eval $x
    echo "network --bootproto dhcp --hostname ${SERVERNAME}.localdomain" > /tmp/network.ks
    ;;
  esac;
done
%end

%post
e2label /dev/mapper/centos-root ROOT
e2label /dev/mapper/centos-swap SWAP

sed -i s,^.*/boot,LABEL=BOOT\\t/boot,g /etc/fstab 
sed -i s,/dev/mapper/centos-root,LABEL\=ROOT,g /etc/fstab
sed -i s,/dev/mapper/centos-swap,LABEL\=SWAP,g /etc/fstab
%end